<script>
  // build items array
  var items = [
      <% @images.each do |image| %>
        {
            <% if image.is_video? %>
              videosrc: "<%= asset_path(image.filename, type: :image, skip_pipeline: true)%>",
              id: "vid-<%= image.id %>",
              vw: <%= image.width %>,
              vh: <%= image.height %>,
              html: '<video id="vid-<%= image.id %>" controls loop><source src="<%= asset_path(image.filename, type: :image, skip_pipeline: true)%>" type="video/<%= image.extension %>"></video>',
            <% else %>
              src: "<%= asset_path(image.filename, type: :image, skip_pipeline: true)%>",
              w: <%= image.width %>,
              h: <%= image.height %>
            <% end %>
        },
      <% end %>
  ];
</script>

<% @images.each_with_index do |i,ind| %>
  <span class="thumb">
    <%= link_to post_path(i), target: :_blank do %>
      <%= content_tag(:div, '', class: 'play-button', onclick: "var pswp = createPhotoSwipe(#{ind});pswp.init();return false;") %>
      <%= image_tag(i.thumbnail_path, class: 'preview', title: i.tag_summary,  skip_pipeline: true) %>
    <% end %>
  </span>
<% end %>
